require 'json'
require 'bigdecimal'

payload = JSON.parse(File.read('payload.json'))

equations = {
  'density' => lambda { |x, y, z| 1 / (1 + Math.exp(-(x**2 + y**2 + z**2) / 100)) },
  'gamma_rays' => lambda do |x, y, z|
    result = 1 / (1 + Math.exp(-(x**2 + y**2 + z**2) / 1000))
    puts "Gamma rays detected at coordinates (#{x}, #{y}, #{z})" if result > 0.5
    result
  end
}

results = {}

equations.each do |equation, function|
  temp_results = {}

  (-100..100).each do |x|
    (-100..100).each do |y|
      (-100..100).each do |z|
        temp_results[equation] ||= {}
        temp_results[equation][x] ||= {}
        temp_results[equation][x][y] = function.call(x, y, z)
      end
    end
  end

  results.merge!(temp_results)
end

File.open('results.json', 'w') do |f|
  f.write(JSON.dump(results))
end
